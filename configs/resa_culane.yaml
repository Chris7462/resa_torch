# RESA Configuration for CULane Dataset

# Model
model:
  backbone: resnet50
  pretrained: true
  num_classes: 5  # 4 lanes + background
  aggregator_channels: 128
  aggregator_iters: 4
  aggregator_kernel_size: 9
  aggregator_alpha: 2.0
  decoder_type: BUSDDecoder # PlainDecoder or BUSDDecoder
  exist_pool_size: [18, 50]

# Dataset
dataset:
  type: CULane
  root: data/CULane

# Preprocessing (train + val)
preprocessing:
  resize_shape: [288, 800]

# Augmentation (train only)
augmentation:
  rotation: 2.0

# Normalization (ImageNet statistics)
normalize:
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]

# Dataloader
dataloader:
  batch_size: 8
  num_workers: 4

# Training
train:
  max_iter: 133320  # Changed from 100000: (88880 / 8) * 12 epochs
  seed: 42

# Optimizer
optimizer:
  type: SGD
  lr: 0.025
  momentum: 0.9
  weight_decay: 0.0001
  nesterov: true

# Learning rate scheduler
lr_scheduler:
  power: 0.9
  warmup: 500
  min_lr: 1.0e-20

# Loss
loss:
  type: cross_entropy  # 'cross_entropy' or 'dice'
  seg_weight: 1.0  # 1.0 for cross_entropy and 2.0 for dice
  exist_weight: 0.1
  background_weight: 0.4
  ignore_index: 255

# Checkpoints
checkpoint:
  save_dir: checkpoints/culane
  interval: 2000

# Logging
logging:
  print_interval: 100

# Evaluation
evaluation:
  y_px_gap: 20
  pts: 18
  thresh: 0.3
  iou_threshold: 0.5
  lane_width: 30
